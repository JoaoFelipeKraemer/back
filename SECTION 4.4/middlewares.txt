node.js: EXPRESS e Middlewares

OQ APRENDEREI
-->Definir o que sÃ£o middlewares;

-->Identificar o que sÃ£o middlewares;

-->Empregar o encadeamento de middlewares usando a funÃ§Ã£o next.

-->Empregar middlewares assÃ­ncronos no express.

-->Empregar a passagem de valores entre middlewares.

-->Empregar middlewares para tratamento de erros.

-->Empregar o uso de rotas aplicando o Router.


-->Os middlewares irÃ£o proporcionar melhor comunicaÃ§Ã£o e maior desempenho nas requisiÃ§Ãµes entre servidor
 e pessoa cliente. Por exemplo, se uma pessoa fizer uma requisiÃ§Ã£o em um formato nÃ£o reconhecido pelo servidor,
  ele pode lanÃ§ar um erro informando que nÃ£o reconhece aquela situaÃ§Ã£o. Por outro lado, se esse servidor 
  possuir um middleware especÃ­fico para a â€œtraduÃ§Ã£oâ€ entre formatos, essa comunicaÃ§Ã£o poderÃ¡ ocorrer sem nenhum prejuÃ­zo

Sendo assim, vocÃª vai observar os middlewares sendo aplicados com os principais objetivos:

-Adicionar funcionalidade de autenticaÃ§Ã£o para dar acesso alguma parte da sua aplicaÃ§Ã£o;
-Definir respostas especÃ­ficas com o status HTTP;
-Reutilizar a lÃ³gica em vÃ¡rias rotas da aplicaÃ§Ã£o.

****relembrando****
EXPRESS:  Ã© um framework com um objetivo central: receber requisiÃ§Ãµes e enviar respostas. 
VocÃª jÃ¡ viu como ele usa funÃ§Ãµes que recebem requisiÃ§Ã£o (req) e resposta (res) como parÃ¢metros.
 Agora, vocÃª verÃ¡ como essas funÃ§Ãµes podem ser decompostas em funÃ§Ãµes menores, que podem ser aproveitadas em diversas rotas.


Refatorando um middleware:
soccer team manager
arquivo refatora.js

 
ğŸš€1 Crie um middleware existingId para garantir que o id passado como parÃ¢metro na rota GET /teams/:id existe no objeto teams.
 Refatore essa rota para usar o middleware.
app soccer
//...
const existingId = (req, res, next) => {
  const id = Number(req.params.id);

  if (teams.some((t) => t.id === id)) {
    // se existe, a requisiÃ§Ã£o segue para o prÃ³ximo middleware
    return next();
  }

  // se nÃ£o existe, entÃ£o vamos retornar o status HTTP 404
  res.sendStatus(404);
};
//...

// usa o middleware
app.get("/teams/:id", existingId, (req, res) => {
  const id = Number(req.params.id);
  const team = teams.find(t => t.id === id);
  res.json(team);
});



ğŸš€2 Reaproveite esse middleware e refatore as rotas PUT /teams/:id e DELETE /teams/:id para usarem ele tambÃ©m.





ğŸš€3 Mova o middleware validateTeam para o arquivo src/middlewares/validateTeam.js, mas continue usando o middleware nas rotas
 POST /teams e PUT /teams/:id.

ğŸš€4 Mova o middleware existingId para o arquivo src/middlewares/existingId.js, mas continue usando o middleware nas rotas PUT
 /teams/:id e DELETE /teams/:id.